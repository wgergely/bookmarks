<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />
        <link rel="canonical" href="https://bookmarks-vfx.com/_modules/bookmarks/items/views.html" />

    <!-- Generated with Sphinx 7.0.1 and Furo 2023.05.20 -->
        <title>bookmarks.items.views - Bookmarks 0.8.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/license_info.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  --color-brand-primary: rgba(75, 180, 135, 1);
  --color-brand-content: rgba(75, 180, 135, 1);
  --color-api-name: rgba(0, 0, 0, 0.9);
  --color-api-pre-name: rgba(75, 180, 135, 0.75);
  --color-highlight-on-target: rgba(0,0,0,0);
  --api-font-size: var(--font-size--normal);
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #232629;
  --color-code-foreground: #cccccc;
  --color-brand-primary: rgba(90, 200, 155, 1);
  --color-brand-content: rgba(90, 200, 155, 1);
  --color-highlight-on-target: rgba(0,0,0,0);
  --color-api-name: rgba(255, 255, 255, 0.9);
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #232629;
  --color-code-foreground: #cccccc;
  --color-brand-primary: rgba(90, 200, 155, 1);
  --color-brand-content: rgba(90, 200, 155, 1);
  --color-highlight-on-target: rgba(0,0,0,0);
  --color-api-name: rgba(255, 255, 255, 0.9);
  
      }
    }
  }
</style>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TX95GG28E5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-TX95GG28E5');
    </script>

    <!-- Clarity tracking code for https://www.bookmarks-vfx.com/ -->
    <script>
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i+"?ref=bwt";
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "e5w2twk64y");
    </script>

    
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Bookmarks 0.8.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/icon.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/icon_bw.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Bookmarks 0.8.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../guide.html">User Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Documentation</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../modules.html">Python Modules</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Python Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/actions.html">actions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/bookmarker.html">bookmarker</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of bookmarker</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/bookmarker/bookmark_editor.html">bookmarker.bookmark_editor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/bookmarker/job_editor.html">bookmarker.job_editor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/bookmarker/main.html">bookmarker.main</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/bookmarker/server_editor.html">bookmarker.server_editor</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/common.html">common</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of common</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/common/core.html">common.core</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/common/data.html">common.data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/common/env.html">common.env</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/common/font.html">common.font</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/common/monitor.html">common.monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/common/sequence.html">common.sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/common/session_lock.html">common.session_lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/common/settings.html">common.settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/common/setup.html">common.setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/common/signals.html">common.signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/common/ui.html">common.ui</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/contextmenu.html">contextmenu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/database.html">database</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/editor.html">editor</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of editor</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/editor/asset_properties.html">editor.asset_properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/editor/base.html">editor.base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/editor/base_widgets.html">editor.base_widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/editor/bookmark_properties.html">editor.bookmark_properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/editor/preferences.html">editor.preferences</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/external.html">external</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of external</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/external/ffmpeg.html">external.ffmpeg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/external/ffmpeg_widget.html">external.ffmpeg_widget</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/external/rv.html">external.rv</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/file_saver.html">file_saver</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of file_saver</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/file_saver/main.html">file_saver.main</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/file_saver/widgets.html">file_saver.widgets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/images.html">images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/importexport.html">importexport</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/items.html">items</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of items</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/asset_items.html">items.asset_items</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/bookmark_items.html">items.bookmark_items</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/delegate.html">items.delegate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/favourite_items.html">items.favourite_items</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/file_items.html">items.file_items</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/models.html">items.models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/task_items.html">items.task_items</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/views.html">items.views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/widgets/filter_editor.html">items.widgets.filter_editor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/widgets/image_viewer.html">items.widgets.image_viewer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/widgets/thumb_capture.html">items.widgets.thumb_capture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/widgets/thumb_library.html">items.widgets.thumb_library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/items/widgets/thumb_picker.html">items.widgets.thumb_picker</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/launcher.html">launcher</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of launcher</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/launcher/gallery.html">launcher.gallery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/launcher/main.html">launcher.main</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/log.html">log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/main.html">main</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/maya.html">maya</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of maya</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/maya/actions.html">maya.actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/maya/base.html">maya.base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/maya/capture.html">maya.capture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/maya/contextmenu.html">maya.contextmenu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/maya/export.html">maya.export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/maya/main.html">maya.main</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/maya/plugin.html">maya.plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/maya/shadertool.html">maya.shadertool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/maya/viewport.html">maya.viewport</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/notes.html">notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/progress.html">progress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/publish.html">publish</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/shortcuts.html">shortcuts</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/shotgun.html">shotgun</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of shotgun</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/shotgun/actions.html">shotgun.actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/shotgun/link.html">shotgun.link</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/shotgun/link_asset.html">shotgun.link_asset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/shotgun/link_assets.html">shotgun.link_assets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/shotgun/link_bookmark.html">shotgun.link_bookmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/shotgun/publish.html">shotgun.publish</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/shotgun/publish_widgets.html">shotgun.publish_widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/shotgun/shotgun.html">shotgun.shotgun</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/shotgun/tasks.html">shotgun.tasks</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/slack.html">slack</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of slack</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/slack/slack.html">slack.slack</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/standalone.html">standalone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/statusbar.html">statusbar</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/teams.html">teams</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of teams</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/teams/message.html">teams.message</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/templates.html">templates</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/threads.html">threads</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of threads</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/threads/threads.html">threads.threads</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/threads/workers.html">threads.workers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/tokens.html">tokens</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of tokens</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/tokens/tokens.html">tokens.tokens</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/tokens/tokens_editor.html">tokens.tokens_editor</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/topbar.html">topbar</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of topbar</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/topbar/buttons.html">topbar.buttons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/topbar/quickswitch.html">topbar.quickswitch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/topbar/tabs.html">topbar.tabs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/topbar/topbar.html">topbar.topbar</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/ui.html">ui</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../modules/versioncontrol.html">versioncontrol</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of versioncontrol</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/versioncontrol/version.html">versioncontrol.version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../modules/versioncontrol/versioncontrol.html">versioncontrol.versioncontrol</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../py-modindex.html">Module Index</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/wgergely/bookmarks">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for bookmarks.items.views</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Base views used to show :mod:`bookmark &lt;bookmarks.items.bookmark_items&gt;`,</span>
<span class="sd">:mod:`asset &lt;bookmarks.items.asset_items&gt;`, and :mod:`file &lt;bookmarks.items.file_items&gt;`</span>
<span class="sd">items.</span>

<span class="sd">The view uses :class:`~bookmarks.items.models.ItemModel` for getting the item data,</span>
<span class="sd">:class:`~bookmarks.items.delegate.ItemDelegate` to paint the items.</span>

<span class="sd">:class:`BaseItemView` is a customised QListView widget augmented by</span>
<span class="sd">:class:`.InlineIconView` (adds inline icon functionality),</span>
<span class="sd">and :class:`.ThreadedItemView` that implement threading related functionality.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">weakref</span>

<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtCore</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">delegate</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">.widgets</span> <span class="kn">import</span> <span class="n">filter_editor</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">actions</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">common</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">contextmenu</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">database</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">images</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">ui</span>
<span class="kn">from</span> <span class="nn">..threads</span> <span class="kn">import</span> <span class="n">threads</span>


<div class="viewcode-block" id="DropIndicatorWidget"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.DropIndicatorWidget">[docs]</a><span class="k">class</span> <span class="nc">DropIndicatorWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Widgets responsible for drawing an overlay.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_TranslucentBackground</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_NoSystemBackground</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_TransparentForMouseEvents</span><span class="p">)</span>

<div class="viewcode-block" id="DropIndicatorWidget.paintEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.DropIndicatorWidget.paintEvent">[docs]</a>    <span class="k">def</span> <span class="nf">paintEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">painter</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">pen</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_blue</span><span class="p">))</span>
        <span class="n">pen</span><span class="o">.</span><span class="n">setWidth</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_indicator</span><span class="p">))</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_blue</span><span class="p">))</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mf">0.35</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">())</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">common</span><span class="o">.</span><span class="n">draw_aliased_text</span><span class="p">(</span>
            <span class="n">painter</span><span class="p">,</span>
            <span class="n">common</span><span class="o">.</span><span class="n">font_db</span><span class="o">.</span><span class="n">bold_font</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_font_medium</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">(),</span>
            <span class="s1">&#39;Drop to add bookmark&#39;</span><span class="p">,</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">,</span>
            <span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_blue</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">end</span><span class="p">()</span></div>

<div class="viewcode-block" id="DropIndicatorWidget.show"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.DropIndicatorWidget.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shows and sets the size of the widget.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">geometry</span><span class="p">())</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="DragPixmapFactory"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.DragPixmapFactory">[docs]</a><span class="k">class</span> <span class="nc">DragPixmapFactory</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Widget used to define the appearance of an item being dragged.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pixmap</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pixmap</span> <span class="o">=</span> <span class="n">pixmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="n">text</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">font_db</span><span class="o">.</span><span class="n">bold_font</span><span class="p">(</span>
            <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_font_medium</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_width</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">horizontalAdvance</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_width</span> <span class="o">+</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_margin</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_width</span><span class="p">)</span> <span class="o">+</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span>
            <span class="n">common</span><span class="o">.</span><span class="n">size_margin</span>
        <span class="p">)</span> <span class="k">if</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_width</span><span class="p">)</span> <span class="k">else</span> <span class="n">width</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_row_height</span><span class="p">))</span>

        <span class="n">longest_edge</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">pixmap</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">pixmap</span><span class="o">.</span><span class="n">height</span><span class="p">()))</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_indicator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span>
            <span class="n">longest_edge</span> <span class="o">+</span> <span class="p">(</span><span class="n">o</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">width</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_NoSystemBackground</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_TranslucentBackground</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_DeleteOnClose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">FramelessWindowHint</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_TransparentForMouseEvents</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjustSize</span><span class="p">()</span>

<div class="viewcode-block" id="DragPixmapFactory.pixmap"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.DragPixmapFactory.pixmap">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">pixmap</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pixmap</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the widget as a rendered pixmap.&quot;&quot;&quot;</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">pixmap</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="n">pixmap</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">*</span> <span class="n">common</span><span class="o">.</span><span class="n">pixel_ratio</span><span class="p">,</span> <span class="p">)</span>
        <span class="n">pixmap</span><span class="o">.</span><span class="n">setDevicePixelRatio</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">pixel_ratio</span><span class="p">)</span>
        <span class="n">pixmap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">transparent</span><span class="p">)</span>
        <span class="n">painter</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(),</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QRegion</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">pixmap</span></div>

<div class="viewcode-block" id="DragPixmapFactory.paintEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.DragPixmapFactory.paintEvent">[docs]</a>    <span class="k">def</span> <span class="nf">paintEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">painter</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_dark_background</span><span class="p">))</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_indicator</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawRoundedRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">(),</span> <span class="n">o</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

        <span class="n">pixmap_rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_row_height</span><span class="p">),</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_row_height</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawPixmap</span><span class="p">(</span><span class="n">pixmap_rect</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pixmap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pixmap</span><span class="o">.</span><span class="n">rect</span><span class="p">())</span>

        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_width</span> <span class="o">+</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_indicator</span><span class="p">)</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_width</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">max_width</span> <span class="k">if</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="n">max_width</span> <span class="k">else</span> <span class="n">width</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span>
            <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_row_height</span><span class="p">)</span> <span class="o">+</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_indicator</span><span class="p">),</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="n">width</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">common</span><span class="o">.</span><span class="n">draw_aliased_text</span><span class="p">(</span>
            <span class="n">painter</span><span class="p">,</span>
            <span class="n">common</span><span class="o">.</span><span class="n">font_db</span><span class="o">.</span><span class="n">bold_font</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_font_medium</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">rect</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">,</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">,</span>
            <span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_selected_text</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">end</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="ItemDrag"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ItemDrag">[docs]</a><span class="k">class</span> <span class="nc">ItemDrag</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QDrag</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A utility class used to start a drag operation.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMimeData</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">mimeData</span><span class="p">([</span><span class="n">index</span><span class="p">,</span> <span class="p">]))</span>

        <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_green</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">images</span><span class="o">.</span><span class="n">rsc_pixmap</span><span class="p">(</span>
                <span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span>
                <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">size_margin</span>
                <span class="p">)</span> <span class="o">*</span> <span class="n">common</span><span class="o">.</span><span class="n">pixel_ratio</span>
            <span class="p">)</span>

        <span class="c1"># Set drag icon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDragCursor</span><span class="p">(</span><span class="n">_get</span><span class="p">(</span><span class="s1">&#39;add_circle&#39;</span><span class="p">),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">CopyAction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDragCursor</span><span class="p">(</span><span class="n">_get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">MoveAction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDragCursor</span><span class="p">(</span>
            <span class="n">_get</span><span class="p">(</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_red</span><span class="p">)),</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ActionMask</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDragCursor</span><span class="p">(</span>
            <span class="n">_get</span><span class="p">(</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_red</span><span class="p">)),</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">IgnoreAction</span>
        <span class="p">)</span>

        <span class="c1"># Set file item apperance</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ItemTabRole</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">BookmarkTab</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">AssetTab</span><span class="p">):</span>
            <span class="n">pixmap</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">rsc_pixmap</span><span class="p">(</span>
                <span class="s1">&#39;copy&#39;</span><span class="p">,</span>
                <span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_disabled_text</span><span class="p">),</span>
                <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_row_height</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">pixmap</span> <span class="o">=</span> <span class="n">DragPixmapFactory</span><span class="o">.</span><span class="n">pixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="p">,</span> <span class="s1">&#39;&lt; Item Properties &gt;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ItemTabRole</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">FileTab</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">FavouriteTab</span><span class="p">):</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">)</span>

            <span class="n">modifiers</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">keyboardModifiers</span><span class="p">()</span>
            <span class="n">no_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoModifier</span>
            <span class="n">alt_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AltModifier</span>
            <span class="n">shift_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ShiftModifier</span>

            <span class="k">if</span> <span class="n">no_modifier</span><span class="p">:</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_sequence_end_path</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
                <span class="n">pixmap</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">get_thumbnail</span><span class="p">(</span>
                    <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">)[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">source</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_row_height</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">alt_modifier</span> <span class="ow">and</span> <span class="n">shift_modifier</span><span class="p">:</span>
                <span class="n">pixmap</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">rsc_pixmap</span><span class="p">(</span>
                    <span class="s1">&#39;folder&#39;</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_secondary_text</span><span class="p">),</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_row_height</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QFileInfo</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="n">dir</span><span class="p">()</span><span class="o">.</span><span class="n">path</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">alt_modifier</span><span class="p">:</span>
                <span class="n">pixmap</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">rsc_pixmap</span><span class="p">(</span>
                    <span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_secondary_text</span><span class="p">),</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_row_height</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_sequence_start_path</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">shift_modifier</span><span class="p">:</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_sequence_start_path</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, ++&#39;</span>
                <span class="n">pixmap</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">rsc_pixmap</span><span class="p">(</span>
                    <span class="s1">&#39;multiples_files&#39;</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_secondary_text</span><span class="p">),</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_row_height</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="n">pixmap</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pixmap</span><span class="o">.</span><span class="n">isNull</span><span class="p">():</span>
                <span class="n">pixmap</span> <span class="o">=</span> <span class="n">DragPixmapFactory</span><span class="o">.</span><span class="n">pixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span></div>


<div class="viewcode-block" id="ListsWidget"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ListsWidget">[docs]</a><span class="k">class</span> <span class="nc">ListsWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStackedWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This stacked widget contains the main bookmark, asset, file and favourite item</span>
<span class="sd">    views.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s1">&#39;BrowserStackedWidget&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QParallelAnimationGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">animation_finished</span><span class="p">)</span>
        <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">tabChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">)</span>

<div class="viewcode-block" id="ListsWidget.setCurrentIndex"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ListsWidget.setCurrentIndex">[docs]</a>    <span class="k">def</span> <span class="nf">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the current index of the ``ListsWidget``.</span>

<span class="sd">        Args:</span>
<span class="sd">            idx (int): The index of the widget to set.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">BookmarkTab</span> <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">idx</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span> <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="n">common</span><span class="o">.</span><span class="n">BookmarkTab</span> <span class="k">else</span> <span class="n">common</span><span class="o">.</span><span class="n">BookmarkTab</span>

        <span class="k">if</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">common</span><span class="o">.</span><span class="n">active_index</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">BookmarkTab</span><span class="p">)</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>
                <span class="ow">and</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">BookmarkTab</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">AssetTab</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">FileTab</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">BookmarkTab</span>

        <span class="k">if</span> <span class="p">(</span>
                <span class="n">common</span><span class="o">.</span><span class="n">active_index</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">BookmarkTab</span><span class="p">)</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">common</span><span class="o">.</span><span class="n">active_index</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">AssetTab</span><span class="p">)</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>
                <span class="ow">and</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">AssetTab</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">FileTab</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">AssetTab</span>

        <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="n">common</span><span class="o">.</span><span class="n">FavouriteTab</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">FavouriteTab</span>

        <span class="c1"># Save tab to user settings</span>
        <span class="n">common</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s1">&#39;selection/current_tab&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>

        <span class="n">current_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">current_index</span> <span class="o">==</span> <span class="n">idx</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">animationAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">a</span><span class="o">.</span><span class="n">currentTime</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">a</span><span class="o">.</span><span class="n">totalDuration</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="n">duration</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="c1"># Create animation for outgoing widget</span>
        <span class="n">out_anim</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPropertyAnimation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">current_index</span><span class="p">),</span> <span class="sa">b</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
        <span class="n">out_anim</span><span class="o">.</span><span class="n">setEasingCurve</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QEasingCurve</span><span class="o">.</span><span class="n">OutQuad</span><span class="p">)</span>
        <span class="n">out_anim</span><span class="o">.</span><span class="n">setDuration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>

        <span class="n">out_rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentWidget</span><span class="p">()</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">current_index</span> <span class="o">&gt;</span> <span class="n">idx</span><span class="p">:</span>
            <span class="n">out_rect</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out_rect</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>
        <span class="n">out_anim</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentWidget</span><span class="p">()</span><span class="o">.</span><span class="n">geometry</span><span class="p">())</span>
        <span class="n">out_anim</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="n">out_rect</span><span class="p">)</span>

        <span class="c1"># Create animation for incoming widget</span>
        <span class="n">in_anim</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPropertyAnimation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">idx</span><span class="p">),</span> <span class="sa">b</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
        <span class="n">in_anim</span><span class="o">.</span><span class="n">setEasingCurve</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QEasingCurve</span><span class="o">.</span><span class="n">OutQuad</span><span class="p">)</span>
        <span class="n">in_anim</span><span class="o">.</span><span class="n">setDuration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>

        <span class="n">in_rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentWidget</span><span class="p">()</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">current_index</span> <span class="o">&gt;</span> <span class="n">idx</span><span class="p">:</span>
            <span class="n">in_rect</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">(</span><span class="o">-</span><span class="n">in_rect</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">in_rect</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">(</span><span class="n">in_rect</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>
        <span class="n">in_anim</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="n">in_rect</span><span class="p">)</span>
        <span class="n">in_anim</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentWidget</span><span class="p">()</span><span class="o">.</span><span class="n">geometry</span><span class="p">())</span>

        <span class="n">out_op</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPropertyAnimation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">current_index</span><span class="p">)</span><span class="o">.</span><span class="n">graphicsEffect</span><span class="p">(),</span> <span class="sa">b</span><span class="s2">&quot;opacity&quot;</span><span class="p">)</span>
        <span class="n">out_op</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">out_op</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">in_op</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPropertyAnimation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">graphicsEffect</span><span class="p">(),</span> <span class="sa">b</span><span class="s2">&quot;opacity&quot;</span><span class="p">)</span>
        <span class="n">in_op</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">in_op</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">addAnimation</span><span class="p">(</span><span class="n">out_anim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">addAnimation</span><span class="p">(</span><span class="n">in_anim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">addAnimation</span><span class="p">(</span><span class="n">out_op</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">addAnimation</span><span class="p">(</span><span class="n">in_op</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">start</span><span class="p">()</span></div>

    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">animation_finished</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">anim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">animationAt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">anim</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anim</span><span class="o">.</span><span class="n">targetObject</span><span class="p">(),</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">anim</span><span class="o">.</span><span class="n">targetObject</span><span class="p">())</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">tabChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

<div class="viewcode-block" id="ListsWidget.showEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ListsWidget.showEvent">[docs]</a>    <span class="k">def</span> <span class="nf">showEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentWidget</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentWidget</span><span class="p">()</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="ThumbnailsContextMenu"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ThumbnailsContextMenu">[docs]</a><span class="k">class</span> <span class="nc">ThumbnailsContextMenu</span><span class="p">(</span><span class="n">contextmenu</span><span class="o">.</span><span class="n">BaseContextMenu</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Context menu associated with thumbnail actions.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ThumbnailsContextMenu.setup"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ThumbnailsContextMenu.setup">[docs]</a>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates the context menu.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sg_thumbnail_menu</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="ProgressWidget"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ProgressWidget">[docs]</a><span class="k">class</span> <span class="nc">ProgressWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Widget responsible for indicating files are being loaded.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ProgressWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_NoSystemBackground</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_TranslucentBackground</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_TransparentForMouseEvents</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Widget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="s1">&#39;Loading...&#39;</span>

<div class="viewcode-block" id="ProgressWidget.showEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ProgressWidget.showEvent">[docs]</a>    <span class="k">def</span> <span class="nf">showEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">geometry</span><span class="p">())</span></div>

<div class="viewcode-block" id="ProgressWidget.set_message"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ProgressWidget.set_message">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the message to be displayed when saving the widget.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="n">text</span></div>

<div class="viewcode-block" id="ProgressWidget.paintEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ProgressWidget.paintEvent">[docs]</a>    <span class="k">def</span> <span class="nf">paintEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">painter</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_separator</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">())</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">common</span><span class="o">.</span><span class="n">draw_aliased_text</span><span class="p">(</span>
            <span class="n">painter</span><span class="p">,</span>
            <span class="n">common</span><span class="o">.</span><span class="n">font_db</span><span class="o">.</span><span class="n">bold_font</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_font_medium</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="p">,</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">,</span>
            <span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_text</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">end</span><span class="p">()</span></div>

<div class="viewcode-block" id="ProgressWidget.mousePressEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ProgressWidget.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="FilterOnOverlayWidget"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.FilterOnOverlayWidget">[docs]</a><span class="k">class</span> <span class="nc">FilterOnOverlayWidget</span><span class="p">(</span><span class="n">ProgressWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An indicator widget drawn on top of the list widgets to signal</span>
<span class="sd">    if a model has filters set or if it requires a refresh.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="FilterOnOverlayWidget.paintEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.FilterOnOverlayWidget.paintEvent">[docs]</a>    <span class="k">def</span> <span class="nf">paintEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">painter</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">paint_filter_indicator</span><span class="p">(</span><span class="n">painter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paint_needs_refresh</span><span class="p">(</span><span class="n">painter</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">end</span><span class="p">()</span></div>

<div class="viewcode-block" id="FilterOnOverlayWidget.paint_needs_refresh"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.FilterOnOverlayWidget.paint_needs_refresh">[docs]</a>    <span class="k">def</span> <span class="nf">paint_needs_refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Paints the data status indicator.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;refresh_needed&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">model</span><span class="o">.</span><span class="n">refresh_needed</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

        <span class="n">o</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_separator</span><span class="p">)</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span><span class="o">.</span><span class="n">adjusted</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="o">-</span><span class="n">o</span><span class="p">,</span> <span class="o">-</span><span class="n">o</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoBrush</span><span class="p">)</span>
        <span class="n">pen</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_blue</span><span class="p">))</span>
        <span class="n">pen</span><span class="o">.</span><span class="n">setWidth</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_separator</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span></div>

<div class="viewcode-block" id="FilterOnOverlayWidget.paint_filter_indicator"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.FilterOnOverlayWidget.paint_filter_indicator">[docs]</a>    <span class="k">def</span> <span class="nf">paint_filter_indicator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Paints the filter indicator.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span><span class="o">.</span><span class="n">rowCount</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_red</span><span class="p">))</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>

        <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">setHeight</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_separator</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">moveBottom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span><span class="o">.</span><span class="n">bottom</span><span class="p">())</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span></div>

<div class="viewcode-block" id="FilterOnOverlayWidget.showEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.FilterOnOverlayWidget.showEvent">[docs]</a>    <span class="k">def</span> <span class="nf">showEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repaint</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="BaseItemView"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView">[docs]</a><span class="k">class</span> <span class="nc">BaseItemView</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableView</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The base view of all subsequent item views.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#: Emitted when the user shift+right-clicks on the view. Use this to show DCC</span>
    <span class="c1">#: specific context menus.</span>
    <span class="n">customContextMenuRequested</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QModelIndex</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QObject</span><span class="p">)</span>
    <span class="c1">#: Called when the user requests model data load by pressing the ESC key.</span>
    <span class="n">interruptRequested</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">()</span>

    <span class="c1">#: Signals window size change</span>
    <span class="n">resized</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">)</span>

    <span class="n">ThumbnailContextMenu</span> <span class="o">=</span> <span class="n">ThumbnailsContextMenu</span>
    <span class="n">Delegate</span> <span class="o">=</span> <span class="ne">NotImplementedError</span>
    <span class="n">ContextMenu</span> <span class="o">=</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icon_bw&#39;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visible_rows</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;source_rows&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;proxy_rows&#39;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setGraphicsEffect</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGraphicsOpacityEffect</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphicsEffect</span><span class="p">()</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAutoFillBackground</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setSectionResizeMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHeaderView</span><span class="o">.</span><span class="n">Fixed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setSectionResizeMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHeaderView</span><span class="o">.</span><span class="n">Stretch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drop_indicator_widget</span> <span class="o">=</span> <span class="n">DropIndicatorWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drop_indicator_widget</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drag_current_row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drag_source_row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setDragDropMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">NoDragDrop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDragEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDropIndicatorShown</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">setAcceptDrops</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAcceptDrops</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setEditTriggers</span><span class="p">(</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">DoubleClicked</span> <span class="o">|</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">EditKeyPressed</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons_hidden</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_drop</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># row, accepted state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background_icon</span> <span class="o">=</span> <span class="n">icon</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">progress_indicator_widget</span> <span class="o">=</span> <span class="n">ProgressWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_indicator_widget</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filter_indicator_widget</span> <span class="o">=</span> <span class="n">FilterOnOverlayWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_editor</span> <span class="o">=</span> <span class="n">filter_editor</span><span class="o">.</span><span class="n">TextFilterEditor</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_editor</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_NoSystemBackground</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_TranslucentBackground</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_NoSystemBackground</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_TranslucentBackground</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">SingleSelection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSelectionBehavior</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">SelectRows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setShowGrid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMouseTracking</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWordWrap</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">installEventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">StrongFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setHorizontalScrollBarPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ScrollBarAsNeeded</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setVerticalScrollBarPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ScrollBarAsNeeded</span><span class="p">)</span>

        <span class="c1"># Keyboard search timer and placeholder string.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">setInterval</span><span class="p">(</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">keyboardInputInterval</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">setSingleShot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timed_search_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_layout_timer</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_layout_timer</span><span class="o">.</span><span class="n">setSingleShot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_layout_timer</span><span class="o">.</span><span class="n">setInterval</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_selection_timer</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_selection_timer</span><span class="o">.</span><span class="n">setSingleShot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_selection_timer</span><span class="o">.</span><span class="n">setInterval</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_restore_selection_timer</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_restore_selection_timer</span><span class="o">.</span><span class="n">setInterval</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_restore_selection_timer</span><span class="o">.</span><span class="n">setSingleShot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_visible_timer</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_visible_timer</span><span class="o">.</span><span class="n">setInterval</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_visible_timer</span><span class="o">.</span><span class="n">setSingleShot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_reset_row_layout_timer</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_reset_row_layout_timer</span><span class="o">.</span><span class="n">setInterval</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_reset_row_layout_timer</span><span class="o">.</span><span class="n">setSingleShot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setItemDelegate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Delegate</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_model</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connect_signals</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_connect_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resized</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_indicator_widget</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resized</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_indicator_widget</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resized</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_editor</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_layout_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scheduleDelayedItemsLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_layout_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repaint_visible_rows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_selection_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_selection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_restore_selection_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">restore_selection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_visible_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_visible_rows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_reset_row_layout_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reset_row_layout</span><span class="p">)</span>

<div class="viewcode-block" id="BaseItemView.get_source_model"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.get_source_model">[docs]</a>    <span class="k">def</span> <span class="nf">get_source_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the model class associated with this view.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Abstract method must be implemented by subclass.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.init_buttons_hidden"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.init_buttons_hidden">[docs]</a>    <span class="nd">@common</span><span class="o">.</span><span class="n">error</span>
    <span class="nd">@common</span><span class="o">.</span><span class="n">debug</span>
    <span class="k">def</span> <span class="nf">init_buttons_hidden</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restore the previous state of the inline icon buttons.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_filter_setting</span><span class="p">(</span><span class="s1">&#39;filters/buttons&#39;</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="k">else</span> <span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons_hidden</span> <span class="o">=</span> <span class="n">v</span></div>

<div class="viewcode-block" id="BaseItemView.buttons_hidden"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.buttons_hidden">[docs]</a>    <span class="k">def</span> <span class="nf">buttons_hidden</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the visibility of the inline icon buttons.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_width</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.66</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buttons_hidden</span></div>

<div class="viewcode-block" id="BaseItemView.set_buttons_hidden"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.set_buttons_hidden">[docs]</a>    <span class="k">def</span> <span class="nf">set_buttons_hidden</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the visibility of the inline icon buttons.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span><span class="o">.</span><span class="n">set_filter_setting</span><span class="p">(</span><span class="s1">&#39;filters/buttons&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons_hidden</span> <span class="o">=</span> <span class="n">val</span></div>

<div class="viewcode-block" id="BaseItemView.init_model"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.init_model">[docs]</a>    <span class="nd">@common</span><span class="o">.</span><span class="n">error</span>
    <span class="nd">@common</span><span class="o">.</span><span class="n">debug</span>
    <span class="k">def</span> <span class="nf">init_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a model to the view.</span>

<span class="sd">        The ItemModel subclasses are wrapped in a QSortFilterProxyModel. All</span>
<span class="sd">        the necessary internal signal-slot connections needed for the proxy, model</span>
<span class="sd">        and the view to communicate are made here.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_source_model</span><span class="p">()</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FilterProxyModel</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">proxy</span><span class="o">.</span><span class="n">setSourceModel</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="n">proxy</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_buttons_hidden</span><span class="p">()</span>
        <span class="n">model</span><span class="o">.</span><span class="n">init_sort_values</span><span class="p">()</span>
        <span class="n">model</span><span class="o">.</span><span class="n">init_row_size</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setDefaultSectionSize</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">row_size</span><span class="o">.</span><span class="n">height</span><span class="p">()))</span>
        <span class="n">proxy</span><span class="o">.</span><span class="n">init_filter_values</span><span class="p">()</span>

        <span class="n">model</span><span class="o">.</span><span class="n">modelReset</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">init_sort_values</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">modelReset</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">proxy</span><span class="o">.</span><span class="n">init_filter_values</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">modelReset</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">init_row_size</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">modelReset</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">init_buttons_hidden</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">modelReset</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reset_multi_toggle</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">modelReset</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">delayed_layout_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delayed_layout_timer</span><span class="o">.</span><span class="n">interval</span><span class="p">())</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">interruptRequested</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">set_interrupt_requested</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filter_editor</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">proxy</span><span class="o">.</span><span class="n">set_filter_text</span><span class="p">)</span>

        <span class="n">model</span><span class="o">.</span><span class="n">modelReset</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delay_restore_selection</span><span class="p">)</span>
        <span class="n">proxy</span><span class="o">.</span><span class="n">invalidated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delay_restore_selection</span><span class="p">)</span>

        <span class="n">model</span><span class="o">.</span><span class="n">modelReset</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_visible_rows</span><span class="p">)</span>
        <span class="n">proxy</span><span class="o">.</span><span class="n">modelReset</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_visible_rows</span><span class="p">)</span>
        <span class="n">proxy</span><span class="o">.</span><span class="n">invalidated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_visible_rows</span><span class="p">)</span>

        <span class="n">model</span><span class="o">.</span><span class="n">updateIndex</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DirectConnection</span><span class="p">)</span>

        <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">paintThumbnailBGChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">repaint_visible_rows</span>
        <span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">rowHeightChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row_size_changed</span><span class="p">)</span></div>

    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">row_size_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setDefaultSectionSize</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_reset_row_layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_visible_rows</span><span class="p">()</span>

<div class="viewcode-block" id="BaseItemView.update"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.update">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QModelIndex</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This slot is used by all threads to repaint/update the given index</span>
<span class="sd">        after it&#39;s thumbnail or file information has been loaded.</span>

<span class="sd">        An actual repaint event will only trigger if the index is visible</span>
<span class="sd">        in the view.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">model</span><span class="p">(),</span> <span class="s1">&#39;sourceModel&#39;</span><span class="p">):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">mapFromSource</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.activate"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.activate">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QModelIndex</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method is called in response to a user action and is used</span>
<span class="sd">        to mark an item `active`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoItemFlags</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># If the item is already active, we&#39;ll emit the standard activated</span>
        <span class="c1"># signal. This will change tabs but won&#39;t trigger a model update</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsActive</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># If the current item is not active, we&#39;ll unset the current active</span>
        <span class="c1"># item&#39;s MarkedAsActive flag and emit the activeChanged signal.</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>
        <span class="n">source_index</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">mapToSource</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="n">model</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="n">source_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.delay_save_selection"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.delay_save_selection">[docs]</a>    <span class="k">def</span> <span class="nf">delay_save_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delays saving the current item selection to the user settings file to reduce</span>
<span class="sd">        the number of file writes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_selection_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_selection_timer</span><span class="o">.</span><span class="n">interval</span><span class="p">())</span></div>

<div class="viewcode-block" id="BaseItemView.save_selection"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.save_selection">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">save_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves the current selection to the user settings file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_selected_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">data_type</span><span class="p">()</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">SequenceItem</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_sequence_start_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="n">model</span><span class="o">.</span><span class="n">set_filter_setting</span><span class="p">(</span><span class="s1">&#39;filters/selection_file&#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_filter_setting</span><span class="p">(</span><span class="s1">&#39;filters/selection_sequence&#39;</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">proxy_path</span><span class="p">(</span><span class="n">path</span><span class="p">))</span></div>

<div class="viewcode-block" id="BaseItemView.delay_restore_selection"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.delay_restore_selection">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">delay_restore_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delays getting the saved selection from the user settings file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_restore_selection_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delayed_restore_selection_timer</span><span class="o">.</span><span class="n">interval</span><span class="p">())</span></div>

<div class="viewcode-block" id="BaseItemView.restore_selection"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.restore_selection">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">restore_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Slot called to reselect a previously saved selection.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">proxy</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">proxy</span><span class="o">.</span><span class="n">rowCount</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">data_type</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">FileItem</span><span class="p">:</span>
            <span class="n">previous</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_filter_setting</span><span class="p">(</span><span class="s1">&#39;filters/selection_file&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">SequenceItem</span><span class="p">:</span>
            <span class="n">previous</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_filter_setting</span><span class="p">(</span><span class="s1">&#39;filters/selection_sequence&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Restore previously saved selection</span>
        <span class="k">if</span> <span class="n">previous</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">proxy</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()):</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
                    <span class="k">continue</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">SequenceItem</span><span class="p">:</span>
                    <span class="n">current</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">proxy_path</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">current</span> <span class="o">=</span> <span class="n">p</span>

                <span class="k">if</span> <span class="n">current</span> <span class="o">!=</span> <span class="n">previous</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># When we found an item, let&#39;s make sure it is visible</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scrollTo</span><span class="p">(</span>
                    <span class="n">index</span><span class="p">,</span>
                    <span class="n">hint</span><span class="o">=</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">PositionAtCenter</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                    <span class="n">index</span><span class="p">,</span>
                    <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span> <span class="o">|</span>
                    <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">Rows</span>
                <span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># Select the active item</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span><span class="o">.</span><span class="n">active_index</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                <span class="n">index</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scrollTo</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">PositionAtCenter</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Select the first item in the list</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
            <span class="n">index</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scrollTo</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">PositionAtCenter</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.toggle_item_flag"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.toggle_item_flag">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_item_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">commit_now</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the index&#39;s filter flag value based on the passed state.</span>

<span class="sd">        We&#39;re using the method to mark items archived, or favourite and save the</span>
<span class="sd">        changes to the database and the user settings file.</span>

<span class="sd">        Args:</span>
<span class="sd">            index (QModelIndex): Model index.</span>
<span class="sd">            flag (int): A filter flag, e.g. ``MarkedAsArchived``.</span>
<span class="sd">            state (bool): Pass an explicit state value. Defaults to None.</span>
<span class="sd">            commit_now (bool): When `True`, commits database values immediately.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The key used to find and match items.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_save_to_db</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">commit_now</span><span class="p">:</span>
                <span class="n">threads</span><span class="o">.</span><span class="n">queue_database_transaction</span><span class="p">(</span>
                    <span class="n">server</span><span class="p">,</span> <span class="n">job</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">database</span><span class="o">.</span><span class="n">set_flag</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">job</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_save_to_user_settings</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mode</span><span class="p">:</span>
                <span class="n">actions</span><span class="o">.</span><span class="n">add_favourite</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">remove_favourite</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_save_active</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">server</span><span class="p">,</span> <span class="n">job</span><span class="p">,</span> <span class="n">root</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>

        <span class="c1"># Ignore default items</span>
        <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span> <span class="ow">and</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span>
                <span class="n">common</span><span class="o">.</span><span class="n">FlagsRole</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsDefault</span><span class="p">:</span>
            <span class="n">ui</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s1">&#39;Default bookmark items cannot be archived.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="c1"># Ignore active items</span>
        <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span> <span class="ow">and</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span>
                <span class="n">common</span><span class="o">.</span><span class="n">FlagsRole</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsActive</span><span class="p">:</span>
            <span class="n">ui</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s1">&#39;This item is currently active and cannot be archived.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span><span class="p">:</span>
            <span class="n">save_func</span> <span class="o">=</span> <span class="n">_save_to_db</span>
        <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsFavourite</span><span class="p">:</span>
            <span class="n">save_func</span> <span class="o">=</span> <span class="n">_save_to_user_settings</span>
        <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsActive</span><span class="p">:</span>
            <span class="n">save_func</span> <span class="o">=</span> <span class="n">_save_active</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">save_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">_set_flag</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Sets a single flag value based on the given mode.&quot;&quot;&quot;</span>
            <span class="c1"># Set the item flag data</span>
            <span class="k">if</span> <span class="n">mode</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">FlagsRole</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">FlagsRole</span><span class="p">]</span> <span class="o">|</span> <span class="n">flag</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">FlagsRole</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">FlagsRole</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">flag</span>

            <span class="c1"># Save the flag value to the data container</span>
            <span class="k">if</span> <span class="n">commit</span><span class="p">:</span>
                <span class="n">save_func</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>

            <span class="c1"># Notify the flag value change</span>
            <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span> <span class="ow">and</span> <span class="n">mode</span><span class="p">:</span>
                <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">itemArchived</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">],</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">mode</span><span class="p">:</span>
                <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">itemUnarchived</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">],</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">],</span>
                <span class="p">)</span>

        <span class="k">def</span> <span class="nf">_set_flags</span><span class="p">(</span><span class="n">DATA</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">proxy</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Sets flags for multiple items.&quot;&quot;&quot;</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">DATA</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">proxy</span><span class="p">:</span>
                    <span class="n">_k</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">proxy_path</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">_k</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">_k</span><span class="p">:</span>
                    <span class="n">_set_flag</span><span class="p">(</span><span class="n">_k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="n">commit</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">can_toggle_flag</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Checks if the given flag can be toggled.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_sequence</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">seq</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="n">proxy_k</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">proxy_path</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsActive</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># not implemented</span>

            <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span><span class="p">:</span>
                <span class="n">db</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">get_db</span><span class="p">(</span><span class="o">*</span><span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>

                <span class="n">flags</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">value</span><span class="p">(</span>
                    <span class="n">proxy_k</span><span class="p">,</span>
                    <span class="s1">&#39;flags&#39;</span><span class="p">,</span>
                    <span class="n">database</span><span class="o">.</span><span class="n">AssetTable</span>
                <span class="p">)</span>
                <span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span> <span class="k">if</span> <span class="n">flags</span> <span class="k">else</span> <span class="mi">0</span>

                <span class="c1"># Active items can&#39;t be archived</span>
                <span class="k">if</span> <span class="n">flags</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsActive</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">flags</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">flags</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsFavourite</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">proxy_k</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">favourites</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">model</span><span class="p">(),</span> <span class="s1">&#39;sourceModel&#39;</span><span class="p">):</span>
            <span class="n">source_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">mapToSource</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source_index</span> <span class="o">=</span> <span class="n">index</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">source_index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">FileInfoLoaded</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">source_path</span><span class="p">()</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">idx</span> <span class="o">=</span> <span class="n">source_index</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">model_data</span><span class="p">()[</span><span class="n">idx</span><span class="p">]</span>

        <span class="n">file_data</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">FileItem</span><span class="p">)</span>
        <span class="n">seq_data</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">SequenceItem</span><span class="p">)</span>

        <span class="n">applied</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">FlagsRole</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">flag</span>
        <span class="n">collapsed</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">is_collapsed</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">])</span>

        <span class="c1"># Determine the mode of operation</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">applied</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">applied</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">state</span>

        <span class="k">if</span> <span class="n">collapsed</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">proxy_path</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">])</span>
            <span class="n">_set_flag</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span><span class="o">.</span><span class="n">model_data</span><span class="p">()</span> <span class="o">==</span> <span class="n">file_data</span><span class="p">:</span>
                <span class="n">_set_flags</span><span class="p">(</span><span class="n">seq_data</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">proxy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_set_flags</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">proxy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">can_toggle_flag</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
                <span class="n">ui</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span>
                    <span class="s1">&#39;Looks like this item belongs to a sequence that has a flag set &#39;</span>
                    <span class="s1">&#39;already.&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;To modify individual sequence items, remove the flag from the &#39;</span>
                    <span class="s1">&#39;sequence first and try again.&#39;</span>
                <span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_multi_toggle</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="n">_set_flag</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span><span class="o">.</span><span class="n">model_data</span><span class="p">()</span> <span class="o">==</span> <span class="n">file_data</span><span class="p">:</span>
                <span class="n">_set_flags</span><span class="p">(</span><span class="n">seq_data</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">proxy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_set_flags</span><span class="p">(</span><span class="n">file_data</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">proxy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">k</span></div>

<div class="viewcode-block" id="BaseItemView.key_space"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.key_space">[docs]</a>    <span class="k">def</span> <span class="nf">key_space</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom key action.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">actions</span><span class="o">.</span><span class="n">preview_thumbnail</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseItemView.key_down"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.key_down">[docs]</a>    <span class="k">def</span> <span class="nf">key_down</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom action on `down` arrow key-press.</span>

<span class="sd">        We&#39;re implementing a continuous scroll: when reaching the last</span>
<span class="sd">        item in the list, we&#39;ll jump to the beginning, and vice-versa.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span>
        <span class="n">current_index</span> <span class="o">=</span> <span class="n">sel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">first_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">first_index</span> <span class="o">==</span> <span class="n">last_index</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">current_index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>  <span class="c1"># No selection</span>
            <span class="n">sel</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                <span class="n">first_index</span><span class="p">,</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">current_index</span> <span class="o">==</span> <span class="n">last_index</span><span class="p">:</span>  <span class="c1"># Last item is selected</span>
            <span class="n">sel</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                <span class="n">first_index</span><span class="p">,</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="n">sel</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current_index</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.key_up"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.key_up">[docs]</a>    <span class="k">def</span> <span class="nf">key_up</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom action to perform when the `up` arrow is pressed</span>
<span class="sd">        on the keyboard.</span>

<span class="sd">        We&#39;re implementing a continuous scroll: when reaching the last</span>
<span class="sd">        item in the list, we&#39;ll jump to the beginning, and vice-versa.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span>
        <span class="n">current_index</span> <span class="o">=</span> <span class="n">sel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">first_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">last_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">first_index</span> <span class="o">==</span> <span class="n">last_index</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">current_index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>  <span class="c1"># No selection</span>
            <span class="n">sel</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                <span class="n">last_index</span><span class="p">,</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
            <span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">current_index</span> <span class="o">==</span> <span class="n">first_index</span><span class="p">:</span>  <span class="c1"># First item is selected</span>
            <span class="n">sel</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                <span class="n">last_index</span><span class="p">,</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="n">sel</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current_index</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.key_tab"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.key_tab">[docs]</a>    <span class="k">def</span> <span class="nf">key_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom key action</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span><span class="o">.</span><span class="n">hasSelection</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span><span class="o">.</span><span class="n">selectedIndexes</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">column</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.key_enter"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.key_enter">[docs]</a>    <span class="k">def</span> <span class="nf">key_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom key action</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">EditingState</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_down</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_up</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_selected_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.get_status_string"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.get_status_string">[docs]</a>    <span class="k">def</span> <span class="nf">get_status_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns an informative string to indicate if the list has hidden items.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>

        <span class="c1"># Model is empty</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;No items&#39;</span>

        <span class="c1"># All items are visible, we don&#39;t have to display anything</span>
        <span class="k">if</span> <span class="n">proxy</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">rowCount</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># Let&#39;s figure out the reason why the list has hidden items</span>
        <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">proxy</span><span class="o">.</span><span class="n">filter_text</span><span class="p">():</span>
            <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;a search filter is applied&#39;</span>
        <span class="k">elif</span> <span class="n">proxy</span><span class="o">.</span><span class="n">filter_flag</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">MarkedAsFavourite</span><span class="p">):</span>
            <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;showing favourites only&#39;</span>
        <span class="k">elif</span> <span class="n">proxy</span><span class="o">.</span><span class="n">filter_flag</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">MarkedAsActive</span><span class="p">):</span>
            <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;showing active item only&#39;</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">proxy</span><span class="o">.</span><span class="n">filter_flag</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span><span class="p">):</span>
            <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;archived items are hidden&#39;</span>

        <span class="c1"># Items are hidden...</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span> <span class="o">-</span> <span class="n">proxy</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1"> item is hidden (</span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1"> items are hidden (</span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s1">)&#39;</span></div>

<div class="viewcode-block" id="BaseItemView.get_hint_string"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.get_hint_string">[docs]</a>    <span class="k">def</span> <span class="nf">get_hint_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns an informative hint text.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span></div>

<div class="viewcode-block" id="BaseItemView.paint_hint"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.paint_hint">[docs]</a>    <span class="k">def</span> <span class="nf">paint_hint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Paints the hint message.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_hint_string</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_paint_message</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_green</span><span class="p">))</span></div>

<div class="viewcode-block" id="BaseItemView.paint_loading"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.paint_loading">[docs]</a>    <span class="k">def</span> <span class="nf">paint_loading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Paints the hint message.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Loading items. Please wait...&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_paint_message</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_text</span><span class="p">))</span></div>

<div class="viewcode-block" id="BaseItemView.paint_status_message"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.paint_status_message">[docs]</a>    <span class="k">def</span> <span class="nf">paint_status_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays a visual hint for the user to indicate if the list</span>
<span class="sd">        has hidden items.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_status_string</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_paint_message</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_red</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="nf">_paint_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">common</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">color_text</span><span class="p">)):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Utility method used to paint a message.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">text</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>

        <span class="n">painter</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setRenderHint</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="o">.</span><span class="n">Antialiasing</span><span class="p">)</span>

        <span class="n">option</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyleOption</span><span class="p">()</span>
        <span class="n">option</span><span class="o">.</span><span class="n">initFrom</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">hover</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_MouseOver</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">painter</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span> <span class="k">if</span> <span class="n">hover</span> <span class="k">else</span> <span class="n">painter</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>

        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span>
            <span class="n">model</span><span class="o">.</span><span class="n">row_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">rect</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="n">proxy</span><span class="o">.</span><span class="n">rowCount</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rect</span><span class="o">.</span><span class="n">moveCenter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span><span class="o">.</span><span class="n">center</span><span class="p">())</span>
                <span class="k">break</span>
            <span class="n">rect</span><span class="o">.</span><span class="n">moveTop</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">setRenderHint</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="o">.</span><span class="n">Antialiasing</span><span class="p">)</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_indicator</span><span class="p">)</span>

        <span class="n">rect</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">adjusted</span><span class="p">(</span><span class="n">o</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="o">-</span><span class="n">o</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="n">o</span><span class="p">)</span>

        <span class="n">font</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">font_db</span><span class="o">.</span><span class="n">bold_font</span><span class="p">(</span>
            <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_font_small</span><span class="p">))</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">elidedText</span><span class="p">(</span>
            <span class="n">text</span><span class="p">,</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ElideRight</span><span class="p">,</span>
            <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">horizontalAdvance</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="n">delegate</span><span class="o">.</span><span class="n">draw_painter_path</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>

<div class="viewcode-block" id="BaseItemView.repaint_visible_rows"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.repaint_visible_rows">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">repaint_visible_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Slot used to repaint all currently visible items.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">mouseButtons</span><span class="p">()</span> <span class="o">!=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoButton</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_rows</span><span class="p">[</span><span class="s1">&#39;proxy_rows&#39;</span><span class="p">]:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">delayed_reset_row_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_reset_row_layout_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delayed_reset_row_layout_timer</span><span class="o">.</span><span class="n">interval</span><span class="p">())</span>

<div class="viewcode-block" id="BaseItemView.reset_row_layout"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.reset_row_layout">[docs]</a>    <span class="nd">@common</span><span class="o">.</span><span class="n">error</span>
    <span class="nd">@common</span><span class="o">.</span><span class="n">debug</span>
    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">reset_row_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Re-initializes the rows to apply size and row height changes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_selected_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Save the current selection</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># Restore the selection</span>
        <span class="k">if</span> <span class="n">row</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                <span class="n">index</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scrollTo</span><span class="p">(</span>
                <span class="n">index</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">PositionAtCenter</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.set_row_size"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.set_row_size">[docs]</a>    <span class="k">def</span> <span class="nf">set_row_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the row size.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            v (int): The new row size</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">row_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">model</span><span class="o">.</span><span class="n">row_size</span><span class="o">.</span><span class="n">setHeight</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_filter_setting</span><span class="p">(</span><span class="s1">&#39;filters/row_heights&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setDefaultSectionSize</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_reset_row_layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_visible_rows</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseItemView.show_item"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.show_item">[docs]</a>    <span class="nd">@common</span><span class="o">.</span><span class="n">error</span>
    <span class="nd">@common</span><span class="o">.</span><span class="n">debug</span>
    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">show_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show an item in the viewer.</span>

<span class="sd">        Args:</span>
<span class="sd">            v (any): A value to match.</span>
<span class="sd">            role (QtCore.Qt.ItemRole): An item data role.</span>
<span class="sd">            update (bool): Refreshes the model if `True` (the default).</span>
<span class="sd">            limit (int): Maximum item search number.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">update</span> <span class="ow">and</span> <span class="n">model</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">reset_data</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">emit_active</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Delay the selection to let the model process events</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_item</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">))</span></div>

<div class="viewcode-block" id="BaseItemView.select_item"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.select_item">[docs]</a>    <span class="k">def</span> <span class="nf">select_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select an item in the viewer.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">model_data</span><span class="p">()</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">data_type</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">SequenceItem</span> <span class="ow">and</span> <span class="n">role</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">:</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">proxy_path</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">role</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">role</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">k</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">mapFromSource</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                    <span class="n">index</span><span class="p">,</span>
                    <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                    <span class="n">index</span><span class="p">,</span>
                    <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scrollTo</span><span class="p">(</span>
                    <span class="n">index</span><span class="p">,</span>
                    <span class="n">hint</span><span class="o">=</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">PositionAtCenter</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_selection</span><span class="p">()</span>
                <span class="k">return</span></div>

    <span class="k">def</span> <span class="nf">_reset_drag_indicators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_drop</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drag_source_row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drag_current_row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopAutoScroll</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setState</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">NoState</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

<div class="viewcode-block" id="BaseItemView.dragMoveEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.dragMoveEvent">[docs]</a>    <span class="k">def</span> <span class="nf">dragMoveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Drag move events checks source validity against available drop actions.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_drop</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">mapFromGlobal</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">mapToSource</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="c1"># Thumbnail image drop</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">can_drop_image_file</span><span class="p">(</span>
                <span class="n">event</span><span class="o">.</span><span class="n">mimeData</span><span class="p">(),</span>
                <span class="n">event</span><span class="o">.</span><span class="n">proposedAction</span><span class="p">(),</span>
                <span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">(),</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QModelIndex</span><span class="p">()</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_drop</span> <span class="o">=</span> <span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># Internal property copy</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">can_drop_properties</span><span class="p">(</span>
                <span class="n">event</span><span class="o">.</span><span class="n">mimeData</span><span class="p">(),</span>
                <span class="n">event</span><span class="o">.</span><span class="n">proposedAction</span><span class="p">(),</span>
                <span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">(),</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QModelIndex</span><span class="p">()</span>
        <span class="p">):</span>
            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_drop</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_drop</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">dragMoveEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.startDrag"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.startDrag">[docs]</a>    <span class="k">def</span> <span class="nf">startDrag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">supported_actions</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Drag action start.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_selected_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">startDrag</span><span class="p">(</span><span class="n">supported_actions</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">startDrag</span><span class="p">(</span><span class="n">supported_actions</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">startDrag</span><span class="p">(</span><span class="n">supported_actions</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drag_source_row</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>

        <span class="n">drag</span> <span class="o">=</span> <span class="n">ItemDrag</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">common</span><span class="o">.</span><span class="n">main_widget</span><span class="o">.</span><span class="n">topbar_widget</span><span class="o">.</span><span class="n">slack_drop_area_widget</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
        <span class="n">drag</span><span class="o">.</span><span class="n">exec_</span><span class="p">(</span><span class="n">supported_actions</span><span class="p">)</span>
        <span class="n">common</span><span class="o">.</span><span class="n">main_widget</span><span class="o">.</span><span class="n">topbar_widget</span><span class="o">.</span><span class="n">slack_drop_area_widget</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reset_drag_indicators</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.dropEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.dropEvent">[docs]</a>    <span class="k">def</span> <span class="nf">dropEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">mapFromGlobal</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reset_drag_indicators</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">mapToSource</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">dropMimeData</span><span class="p">(</span>
                <span class="n">event</span><span class="o">.</span><span class="n">mimeData</span><span class="p">(),</span>
                <span class="n">event</span><span class="o">.</span><span class="n">proposedAction</span><span class="p">(),</span>
                <span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">(),</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QModelIndex</span><span class="p">()</span>
        <span class="p">):</span>
            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reset_drag_indicators</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_drag_indicators</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseItemView.showEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.showEvent">[docs]</a>    <span class="k">def</span> <span class="nf">showEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scheduleDelayedItemsLayout</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseItemView.mouseReleaseEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.mouseReleaseEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseReleaseEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mouseReleaseEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseItemView.eventFilter"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.eventFilter">[docs]</a>    <span class="k">def</span> <span class="nf">eventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event filter handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">widget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QEvent</span><span class="o">.</span><span class="n">Paint</span><span class="p">:</span>
            <span class="n">ui</span><span class="o">.</span><span class="n">paint_background_icon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_background_icon</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span><span class="o">.</span><span class="n">_load_in_progress</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">paint_loading</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">paint_hint</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">paint_status_message</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="BaseItemView.resizeEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.resizeEvent">[docs]</a>    <span class="k">def</span> <span class="nf">resizeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_layout_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delayed_layout_timer</span><span class="o">.</span><span class="n">interval</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resized</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">geometry</span><span class="p">())</span></div>

<div class="viewcode-block" id="BaseItemView.keyPressEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.keyPressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">keyPressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Key press event handler.</span>

<span class="sd">        We&#39;re defining the default behaviour of the list-items here, including</span>
<span class="sd">        defining the actions needed to navigate the list using keyboard presses.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">numpad_modifier</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">KeypadModifier</span>
        <span class="n">no_modifier</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoModifier</span>

        <span class="k">if</span> <span class="n">no_modifier</span> <span class="ow">or</span> <span class="n">numpad_modifier</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">isActive</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">timed_search_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Escape</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">EditingState</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">key_down</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">key_up</span><span class="p">()</span>
                    <span class="k">return</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">interruptRequested</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span><span class="o">.</span><span class="n">hasSelection</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                        <span class="n">QtCore</span><span class="o">.</span><span class="n">QModelIndex</span><span class="p">(),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
                    <span class="p">)</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Space</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">key_space</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Down</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">key_down</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Up</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">key_up</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Return</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Enter</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">key_enter</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Tab</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">EditingState</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">key_tab</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">key_down</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">key_tab</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                    <span class="k">return</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Backtab</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">EditingState</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">key_tab</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">key_up</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">key_tab</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                    <span class="k">return</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_PageDown</span><span class="p">:</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">keyPressEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_PageUp</span><span class="p">:</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">keyPressEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Home</span><span class="p">:</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">keyPressEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_End</span><span class="p">:</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">keyPressEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">timed_search_string</span> <span class="o">+=</span> <span class="n">event</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

            <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()):</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QModelIndex</span><span class="p">())</span>
                <span class="c1"># When only one key is pressed we want to cycle through</span>
                <span class="c1"># only items starting with that letter:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timed_search_string</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="n">sel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">.</span><span class="n">row</span><span class="p">():</span>
                        <span class="k">continue</span>

                    <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">)[</span>
                        <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">timed_search_string</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                        <span class="n">sel</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                            <span class="n">index</span><span class="p">,</span>
                            <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
                        <span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                        <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">timed_search_string</span><span class="p">,</span>
                            <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">),</span>
                            <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span>
                        <span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">match</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                        <span class="n">sel</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                            <span class="n">index</span><span class="p">,</span>
                            <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
                        <span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                        <span class="k">return</span>

        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ShiftModifier</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Tab</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">key_up</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">key_tab</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Backtab</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">key_up</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">key_tab</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delay_save_selection</span><span class="p">()</span>
                <span class="k">return</span></div>

<div class="viewcode-block" id="BaseItemView.wheelEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.wheelEvent">[docs]</a>    <span class="k">def</span> <span class="nf">wheelEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom wheel event responsible for scrolling the list.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
        <span class="n">control_modifier</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ControlModifier</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">control_modifier</span><span class="p">:</span>
            <span class="n">shift_modifier</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ShiftModifier</span>

            <span class="c1"># Adjust the scroll amount based on the row size</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span><span class="o">.</span><span class="n">row_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">&gt;</span> <span class="p">(</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">size_row_height</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">o</span> <span class="o">=</span> <span class="mi">9</span> <span class="k">if</span> <span class="n">shift_modifier</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">o</span> <span class="o">=</span> <span class="mi">9</span> <span class="k">if</span> <span class="n">shift_modifier</span> <span class="k">else</span> <span class="mi">3</span>

            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">angleDelta</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="n">o</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">o</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_delayed_queue_timer</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">angleDelta</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">increase_row_size</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">decrease_row_size</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_delayed_queue_timer</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseItemView.contextMenuEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.contextMenuEvent">[docs]</a>    <span class="k">def</span> <span class="nf">contextMenuEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom context menu event.&quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span> <span class="ow">and</span> <span class="n">index</span><span class="o">.</span><span class="n">column</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">shift_modifier</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ShiftModifier</span>
        <span class="n">alt_modifier</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AltModifier</span>
        <span class="n">control_modifier</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ControlModifier</span>

        <span class="k">if</span> <span class="n">shift_modifier</span> <span class="ow">or</span> <span class="n">alt_modifier</span> <span class="ow">or</span> <span class="n">control_modifier</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">customContextMenuRequested</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ContextMenu</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">rectangles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemDelegate</span><span class="p">()</span><span class="o">.</span><span class="n">get_rectangles</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span> <span class="ow">and</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">ThumbnailRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">()):</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ThumbnailContextMenu</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ContextMenu</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">widget</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
        <span class="n">common</span><span class="o">.</span><span class="n">move_widget_to_available_geo</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseItemView.mousePressEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deselect the current index when clicked on an empty space.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">cursor_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">mapFromGlobal</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QModelIndex</span><span class="p">(),</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QItemSelectionModel</span><span class="o">.</span><span class="n">ClearAndSelect</span>
            <span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseItemView.mouseDoubleClickEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.BaseItemView.mouseDoubleClickEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseDoubleClickEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom doubleclick event.</span>

<span class="sd">        A double click can `activate` an item, or it can trigger an edit event.</span>
<span class="sd">        As each item is associated with multiple editors we have to inspect</span>
<span class="sd">        the double click location before deciding what action to take.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">cursor_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">mapFromGlobal</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">column</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">rectangles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemDelegate</span><span class="p">()</span><span class="o">.</span><span class="n">get_rectangles</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="n">_rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visualRect</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">rect</span> <span class="o">=</span> <span class="n">delegate</span><span class="o">.</span><span class="n">get_description_rectangle</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">_rect</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons_hidden</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">rect</span> <span class="ow">and</span> <span class="n">rect</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">ThumbnailRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                <span class="n">actions</span><span class="o">.</span><span class="n">pick_thumbnail_from_file</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">DataRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">get_selected_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
                    <span class="k">return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mouseDoubleClickEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="InlineIconView"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.InlineIconView">[docs]</a><span class="k">class</span> <span class="nc">InlineIconView</span><span class="p">(</span><span class="n">BaseItemView</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds multi-toggle and clickable in-line icons to :class:`BaseItemView`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;bw_icon&#39;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">icon</span><span class="o">=</span><span class="n">icon</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_clicked_rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_pos</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_flag</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_item</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_items</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="InlineIconView.inline_icons_count"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.InlineIconView.inline_icons_count">[docs]</a>    <span class="k">def</span> <span class="nf">inline_icons_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inline buttons count.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="InlineIconView.reset_multi_toggle"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.InlineIconView.reset_multi_toggle">[docs]</a>    <span class="k">def</span> <span class="nf">reset_multi_toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resets the multi-toggle state.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_pos</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_flag</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_item</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_items</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="InlineIconView.clickable_rectangle_event"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.InlineIconView.clickable_rectangle_event">[docs]</a>    <span class="k">def</span> <span class="nf">clickable_rectangle_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle mouse press &amp; release events on an item&#39;s interactive rectangle.</span>

<span class="sd">        The clickable rectangles are defined by and stored by the item delegate. See</span>
<span class="sd">        :meth:`~bookmarks.items.ItemDelegate.get_clickable_rectangles`.</span>

<span class="sd">        We&#39;re implementing filtering by reacting to clicks on item labels:</span>
<span class="sd">        ``shift`` modifier will add a _positive_ filter and hide all items not</span>
<span class="sd">        containing the clicked rectangle&#39;s text content.</span>

<span class="sd">        The ``alt`` and ``control`` modifiers will add a negative filter and hide all</span>
<span class="sd">        items containing the clicked rectangle&#39;s text content.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cursor_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">mapFromGlobal</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">column</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Get pressed keyboard modifiers</span>
        <span class="n">modifiers</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">keyboardModifiers</span><span class="p">()</span>
        <span class="n">alt_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AltModifier</span>
        <span class="n">shift_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ShiftModifier</span>
        <span class="n">control_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ControlModifier</span>

        <span class="c1"># Get clickable rectangles from the delegate</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visualRect</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">clickable_rectangles</span> <span class="o">=</span> <span class="n">delegate</span><span class="o">.</span><span class="n">get_clickable_rectangles</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">clickable_rectangles</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">cursor_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">mapFromGlobal</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">clickable_rectangles</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">item</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">rect</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">item</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">text</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">rect</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="n">filter_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">filter_text</span><span class="p">()</span>
            <span class="n">filter_text</span> <span class="o">=</span> <span class="n">filter_text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">filter_text</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>

            <span class="k">if</span> <span class="n">shift_modifier</span><span class="p">:</span>
                <span class="c1"># Shift modifier will add a &quot;positive&quot; filter and hide all items</span>
                <span class="c1"># that does not contain the given text.</span>
                <span class="n">folder_filter</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

                <span class="k">if</span> <span class="n">folder_filter</span> <span class="ow">in</span> <span class="n">filter_text</span><span class="p">:</span>
                    <span class="n">filter_text</span> <span class="o">=</span> <span class="n">filter_text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">folder_filter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">filter_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filter_text</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">folder_filter</span><span class="si">}</span><span class="s1">&#39;</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">set_filter_text</span><span class="p">(</span><span class="n">filter_text</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">repaint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">())</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="n">alt_modifier</span> <span class="ow">or</span> <span class="n">control_modifier</span><span class="p">:</span>
                <span class="c1"># The alt or control modifiers will add a &quot;negative filter&quot;</span>
                <span class="c1"># and hide the selected sub-folder from the view</span>
                <span class="n">folder_filter</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;--&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
                <span class="n">_folder_filter</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

                <span class="k">if</span> <span class="n">filter_text</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">_folder_filter</span> <span class="ow">in</span> <span class="n">filter_text</span><span class="p">:</span>
                        <span class="n">filter_text</span> <span class="o">=</span> <span class="n">filter_text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">_folder_filter</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">folder_filter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filter_text</span><span class="p">:</span>
                        <span class="n">folder_filter</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filter_text</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">folder_filter</span><span class="si">}</span><span class="s1">&#39;</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">set_filter_text</span><span class="p">(</span><span class="n">folder_filter</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">repaint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">())</span>
                <span class="k">return</span></div>

<div class="viewcode-block" id="InlineIconView.mousePressEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.InlineIconView.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The `InlineIconView`&#39;s mousePressEvent initiates multi-row</span>
<span class="sd">        flag toggling.</span>

<span class="sd">        This event is responsible for setting ``multi_toggle_pos``, the start</span>
<span class="sd">        position of the toggle, ``multi_toggle_state`` &amp; ``multi_toggle_flag``</span>
<span class="sd">        the modes of the toggle, based on the state of the state and location of</span>
<span class="sd">        the clicked item.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_multi_toggle</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">cursor_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">mapFromGlobal</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">column</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span><span class="p">:</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_clicked_rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_multi_toggle</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">reset_multi_toggle</span><span class="p">()</span>

            <span class="n">rectangles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemDelegate</span><span class="p">()</span><span class="o">.</span><span class="n">get_rectangles</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_clicked_rect</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
                <span class="p">(</span><span class="n">rectangles</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">(</span>
                    <span class="n">delegate</span><span class="o">.</span><span class="n">AddItemRect</span><span class="p">,</span>
                    <span class="n">delegate</span><span class="o">.</span><span class="n">TodoRect</span><span class="p">,</span>
                    <span class="n">delegate</span><span class="o">.</span><span class="n">RevealRect</span><span class="p">,</span>
                    <span class="n">delegate</span><span class="o">.</span><span class="n">PropertiesRect</span><span class="p">,</span>
                    <span class="n">delegate</span><span class="o">.</span><span class="n">ArchiveRect</span><span class="p">,</span>
                    <span class="n">delegate</span><span class="o">.</span><span class="n">FavouriteRect</span><span class="p">,</span>
                <span class="p">)</span> <span class="k">if</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">)),</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">()</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">FavouriteRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_pos</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cursor_position</span><span class="o">.</span><span class="n">y</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_state</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsFavourite</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_flag</span> <span class="o">=</span> <span class="n">delegate</span><span class="o">.</span><span class="n">FavouriteRect</span>

            <span class="k">if</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">ArchiveRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_pos</span> <span class="o">=</span> <span class="n">cursor_position</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_state</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_flag</span> <span class="o">=</span> <span class="n">delegate</span><span class="o">.</span><span class="n">ArchiveRect</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="InlineIconView.enterEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.InlineIconView.enterEvent">[docs]</a>    <span class="k">def</span> <span class="nf">enterEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">enterEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="InlineIconView.leaveEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.InlineIconView.leaveEvent">[docs]</a>    <span class="k">def</span> <span class="nf">leaveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Event handler.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
        <span class="n">app</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span></div>

<div class="viewcode-block" id="InlineIconView.mouseReleaseEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.InlineIconView.mouseReleaseEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseReleaseEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Concludes `InlineIconView`&#39;s multi-item toggle operation, and</span>
<span class="sd">        resets the associated variables.</span>

<span class="sd">        The inline icon buttons are also triggered here. We&#39;re using the</span>
<span class="sd">        delegate&#39;s ``get_rectangles`` function to determine which icon was</span>
<span class="sd">        clicked.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_multi_toggle</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">modifiers</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">keyboardModifiers</span><span class="p">()</span>
        <span class="n">alt_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AltModifier</span>
        <span class="n">shift_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ShiftModifier</span>
        <span class="n">control_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ControlModifier</span>

        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">column</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">FlagsRole</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">archived</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">FlagsRole</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span>

            <span class="c1"># Let&#39;s handle the clickable rectangle event first</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">archived</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clickable_rectangle_event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_multi_toggle</span><span class="p">()</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mouseReleaseEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_items</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_multi_toggle</span><span class="p">()</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mouseReleaseEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">invalidateFilter</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="c1"># Responding the click-events based on the position:</span>
            <span class="n">rectangles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemDelegate</span><span class="p">()</span><span class="o">.</span><span class="n">get_rectangles</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">cursor_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">mapFromGlobal</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">reset_multi_toggle</span><span class="p">()</span>

            <span class="k">def</span> <span class="nf">_check_rect</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">f</span><span class="p">]</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">cursor_position</span>
                <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clicked_rect</span>

            <span class="k">if</span> <span class="n">_check_rect</span><span class="p">(</span><span class="n">delegate</span><span class="o">.</span><span class="n">FavouriteRect</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">archived</span><span class="p">:</span>
                <span class="n">actions</span><span class="o">.</span><span class="n">toggle_favourite</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">filter_flag</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">MarkedAsFavourite</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">invalidateFilter</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">_check_rect</span><span class="p">(</span><span class="n">delegate</span><span class="o">.</span><span class="n">ArchiveRect</span><span class="p">):</span>
                <span class="n">actions</span><span class="o">.</span><span class="n">toggle_archived</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">filter_flag</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">invalidateFilter</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">_check_rect</span><span class="p">(</span><span class="n">delegate</span><span class="o">.</span><span class="n">RevealRect</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">archived</span><span class="p">:</span>
                <span class="c1"># Reveal the job folder if any of the modifiers are pressed</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">alt_modifier</span><span class="p">,</span> <span class="n">shift_modifier</span><span class="p">,</span> <span class="n">control_modifier</span><span class="p">)):</span>
                    <span class="n">pp</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ParentPathRole</span><span class="p">)</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">pp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="n">actions</span><span class="o">.</span><span class="n">reveal</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">actions</span><span class="o">.</span><span class="n">reveal</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">_check_rect</span><span class="p">(</span><span class="n">delegate</span><span class="o">.</span><span class="n">TodoRect</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">archived</span><span class="p">:</span>
                <span class="n">actions</span><span class="o">.</span><span class="n">show_notes</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">_check_rect</span><span class="p">(</span><span class="n">delegate</span><span class="o">.</span><span class="n">AddItemRect</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">archived</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_item_action</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">_check_rect</span><span class="p">(</span><span class="n">delegate</span><span class="o">.</span><span class="n">PropertiesRect</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">archived</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edit_item_action</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_clicked_rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mouseReleaseEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="InlineIconView.add_item_action"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.InlineIconView.add_item_action">[docs]</a>    <span class="k">def</span> <span class="nf">add_item_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Action to execute when the add item icon is clicked.&quot;&quot;&quot;</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="InlineIconView.edit_item_action"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.InlineIconView.edit_item_action">[docs]</a>    <span class="k">def</span> <span class="nf">edit_item_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Action to execute when the edit item icon is clicked.&quot;&quot;&quot;</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="InlineIconView.mouseMoveEvent"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.InlineIconView.mouseMoveEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseMoveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;``InlineIconView``&#39;s mouse move event is responsible for</span>
<span class="sd">        handling the multi-toggle operations and repainting the current index</span>
<span class="sd">        under the mouse.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">isSliderDown</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">app</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">common</span><span class="o">.</span><span class="n">cursor</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">cursor_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewport</span><span class="p">()</span><span class="o">.</span><span class="n">mapFromGlobal</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">cursor</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>

        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="n">app</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">column</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">app</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">modifiers</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">keyboardModifiers</span><span class="p">()</span>
        <span class="n">alt_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AltModifier</span>
        <span class="n">shift_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ShiftModifier</span>
        <span class="n">control_modifier</span> <span class="o">=</span> <span class="n">modifiers</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ControlModifier</span>

        <span class="k">if</span> <span class="n">alt_modifier</span> <span class="ow">or</span> <span class="n">shift_modifier</span> <span class="ow">or</span> <span class="n">control_modifier</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="n">rectangles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemDelegate</span><span class="p">()</span><span class="o">.</span><span class="n">get_rectangles</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="c1"># Status messages</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">buttons</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoButton</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">PropertiesRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">showStatusTipMessage</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                        <span class="s1">&#39;Edit item properties...&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">AddItemRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">showStatusTipMessage</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                        <span class="s1">&#39;Add New Item...&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">TodoRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">showStatusTipMessage</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                        <span class="s1">&#39;Edit Notes...&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">RevealRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">showStatusTipMessage</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                        <span class="s1">&#39;Show item in File Explorer...&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">ArchiveRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">showStatusTipMessage</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                        <span class="s1">&#39;Archive item...&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">FavouriteRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">showStatusTipMessage</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                        <span class="s1">&#39;Star item...&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">ThumbnailRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">showStatusTipMessage</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                        <span class="s1">&#39;Drag and drop an image, or right-click to edit the thumbnail...&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">InlineBackgroundRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">clearStatusBarMessage</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rectangles</span><span class="p">[</span><span class="n">delegate</span><span class="o">.</span><span class="n">DataRect</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">showStatusTipMessage</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                        <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">clearStatusBarMessage</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
                <span class="n">app</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="n">rect</span> <span class="o">=</span> <span class="n">delegate</span><span class="o">.</span><span class="n">get_description_rectangle</span><span class="p">(</span>
                <span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">visualRect</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons_hidden</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">rect</span> <span class="ow">and</span> <span class="n">rect</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_position</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">app</span><span class="o">.</span><span class="n">overrideCursor</span><span class="p">():</span>
                    <span class="n">app</span><span class="o">.</span><span class="n">changeOverrideCursor</span><span class="p">(</span>
                        <span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">IBeamCursor</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">app</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
                    <span class="n">app</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">IBeamCursor</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">app</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mouseMoveEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">buttons</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoButton</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">initial_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_pos</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>

        <span class="c1"># Exclude the current item</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_item</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_item</span> <span class="o">=</span> <span class="n">index</span>

        <span class="n">favourite</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsFavourite</span>
        <span class="n">archived</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span>

        <span class="k">if</span> <span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_items</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_flag</span> <span class="o">==</span> <span class="n">delegate</span><span class="o">.</span><span class="n">FavouriteRect</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_items</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">favourite</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toggle_item_flag</span><span class="p">(</span>
                    <span class="n">index</span><span class="p">,</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsFavourite</span><span class="p">,</span>
                    <span class="n">state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_state</span><span class="p">,</span>
                    <span class="n">commit_now</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_flag</span> <span class="o">==</span> <span class="n">delegate</span><span class="o">.</span><span class="n">ArchiveRect</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_items</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">archived</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toggle_item_flag</span><span class="p">(</span>
                    <span class="n">index</span><span class="p">,</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span><span class="p">,</span>
                    <span class="n">state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multi_toggle_state</span><span class="p">,</span>
                    <span class="n">commit_now</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="n">initial_index</span><span class="p">:</span>
            <span class="k">return</span></div></div>


<div class="viewcode-block" id="ThreadedItemView"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ThreadedItemView">[docs]</a><span class="k">class</span> <span class="nc">ThreadedItemView</span><span class="p">(</span><span class="n">InlineIconView</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extends the :class:`InlineIconView` with the methods used to interface with</span>
<span class="sd">    threads.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">workerInitialized</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">refUpdated</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">)</span>
    <span class="n">queueItems</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="n">queues</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;bw_icon&#39;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_queue_timer</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Timer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_queue_timer</span><span class="o">.</span><span class="n">setInterval</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_queue_timer</span><span class="o">.</span><span class="n">setSingleShot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">icon</span><span class="o">=</span><span class="n">icon</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">([],</span> <span class="n">common</span><span class="o">.</span><span class="n">max_list_items</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue_timer</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue_timer</span><span class="o">.</span><span class="n">setSingleShot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue_timer</span><span class="o">.</span><span class="n">setInterval</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queued_row_repaint</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_threads</span><span class="p">()</span>

<div class="viewcode-block" id="ThreadedItemView.init_threads"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ThreadedItemView.init_threads">[docs]</a>    <span class="nd">@common</span><span class="o">.</span><span class="n">debug</span>
    <span class="nd">@common</span><span class="o">.</span><span class="n">error</span>
    <span class="k">def</span> <span class="nf">init_threads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Starts and connects the threads.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">queues</span><span class="p">:</span>
            <span class="n">thread</span> <span class="o">=</span> <span class="n">threads</span><span class="o">.</span><span class="n">get_thread</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
            <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="c1"># Wait for all threads to spin up before continuing</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="kn">import</span> <span class="nn">time</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">threads</span><span class="o">.</span><span class="n">get_thread</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">isRunning</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">queues</span><span class="p">]):</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mf">0.1</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mf">2.0</span><span class="p">:</span>
                <span class="k">break</span></div>

<div class="viewcode-block" id="ThreadedItemView.init_model"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ThreadedItemView.init_model">[docs]</a>    <span class="nd">@common</span><span class="o">.</span><span class="n">error</span>
    <span class="nd">@common</span><span class="o">.</span><span class="n">debug</span>
    <span class="k">def</span> <span class="nf">init_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The methods responsible for connecting the associated item model with the view.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">init_model</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refUpdated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_row</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_queue_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_visible_rows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_queue_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_visible_indexes</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">invalidated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_delayed_queue_timer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span><span class="o">.</span><span class="n">modelReset</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_delayed_queue_timer</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">verticalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_delayed_queue_timer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">sliderReleased</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_delayed_queue_timer</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">filterTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_delayed_queue_timer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">filterFlagChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_delayed_queue_timer</span><span class="p">)</span>

        <span class="n">common</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">tabChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_delayed_queue_timer</span><span class="p">)</span></div>

<div class="viewcode-block" id="ThreadedItemView.start_delayed_queue_timer"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ThreadedItemView.start_delayed_queue_timer">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">()</span>
    <span class="nd">@common</span><span class="o">.</span><span class="n">debug</span>
    <span class="k">def</span> <span class="nf">start_delayed_queue_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Starts the delayed queue timer.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_queue_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delayed_queue_timer</span><span class="o">.</span><span class="n">interval</span><span class="p">())</span></div>

    <span class="nd">@common</span><span class="o">.</span><span class="n">status_bar_message</span><span class="p">(</span><span class="s1">&#39;Updating items...&#39;</span><span class="p">)</span>
    <span class="nd">@common</span><span class="o">.</span><span class="n">debug</span>
    <span class="k">def</span> <span class="nf">queue_visible_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method will send all currently visible items to the worker</span>
<span class="sd">        threads for processing.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">proxy</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">sourceModel</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">model</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">model_data</span><span class="p">()</span>

        <span class="n">show_archived</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">filter_flag</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">queues</span><span class="p">:</span>
                <span class="n">role</span> <span class="o">=</span> <span class="n">threads</span><span class="o">.</span><span class="n">THREADS</span><span class="p">[</span><span class="n">q</span><span class="p">][</span><span class="s1">&#39;role&#39;</span><span class="p">]</span>

                <span class="c1"># Skip queues that have their data already preloaded</span>
                <span class="k">if</span> <span class="n">threads</span><span class="o">.</span><span class="n">THREADS</span><span class="p">[</span><span class="n">q</span><span class="p">][</span><span class="s1">&#39;preload&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">loaded</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">refs</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_rows</span><span class="p">[</span><span class="s1">&#39;source_rows&#39;</span><span class="p">]:</span>

                    <span class="c1"># Item is already loaded, skip</span>
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">role</span><span class="p">]:</span>
                        <span class="k">continue</span>

                    <span class="c1"># Check if any of the current items are archived and invalidate</span>
                    <span class="c1"># the filter if it is meant to be hidden</span>
                    <span class="n">is_archived</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">common</span><span class="o">.</span><span class="n">FlagsRole</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">common</span><span class="o">.</span><span class="n">MarkedAsArchived</span>
                    <span class="k">if</span> <span class="n">show_archived</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">is_archived</span><span class="p">:</span>
                        <span class="n">proxy</span><span class="o">.</span><span class="n">invalidateFilter</span><span class="p">()</span>
                        <span class="k">return</span>

                    <span class="n">refs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">queueItems</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">refs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span>

<div class="viewcode-block" id="ThreadedItemView.update_row"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ThreadedItemView.update_row">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">(</span><span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">update_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Queues an update request by the threads for later processing.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ref</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">ref</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_queue_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_queue_timer</span><span class="o">.</span><span class="n">interval</span><span class="p">())</span></div>

<div class="viewcode-block" id="ThreadedItemView.queued_row_repaint"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ThreadedItemView.queued_row_repaint">[docs]</a>    <span class="k">def</span> <span class="nf">queued_row_repaint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a repaint request.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ref</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_rows</span><span class="p">[</span><span class="s1">&#39;proxy_rows&#39;</span><span class="p">]:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">)</span> <span class="o">==</span> <span class="n">ref</span><span class="p">()[</span><span class="n">common</span><span class="o">.</span><span class="n">PathRole</span><span class="p">]:</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">break</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_queue_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_queue_timer</span><span class="o">.</span><span class="n">interval</span><span class="p">())</span></div>

    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">delayed_save_visible_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_visible_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delayed_save_visible_timer</span><span class="o">.</span><span class="n">interval</span><span class="p">())</span>

<div class="viewcode-block" id="ThreadedItemView.save_visible_rows"><a class="viewcode-back" href="../../../modules/items/views.html#bookmarks.items.views.ThreadedItemView.save_visible_rows">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">Slot</span><span class="p">()</span>
    <span class="nd">@common</span><span class="o">.</span><span class="n">debug</span>
    <span class="k">def</span> <span class="nf">save_visible_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cache the currently visible rows.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visible_rows</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;source_rows&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;proxy_rows&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>

        <span class="c1"># Find the first visible index</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">topLeft</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visualRect</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">while</span> <span class="n">r</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">rect</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">999</span><span class="p">:</span>  <span class="c1"># Don&#39;t check more than 999 items</span>
                <span class="k">break</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">visible_rows</span><span class="p">[</span><span class="s1">&#39;proxy_rows&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visible_rows</span><span class="p">[</span><span class="s1">&#39;source_rows&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">IdRole</span><span class="p">))</span>

            <span class="n">rect</span><span class="o">.</span><span class="n">moveTop</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexAt</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">topLeft</span><span class="p">())</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
                <span class="k">break</span></div></div>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169;  2022 Gergely Wootsch
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/design-tabs.js"></script>
    </body>
</html>