"""A custom environment setter for Bookmark's python interpreter.

It ensures the correct dynamic-link libraries (DLLs) are loaded when the
Python interactive console is launched. .pythonstartup is executed each
time the interpreter is started.

"""
import os
import sys

pythonhome = os.environ.get("PYTHONHOME")
bin_path = os.path.join(pythonhome, "bin")
core_path = os.path.join(pythonhome, "core")

if sys.version_info >= (3, 8):
    os.add_dll_directory(pythonhome)
    os.add_dll_directory(bin_path)
    os.add_dll_directory(core_path)
else:
    os.environ["PATH"] += os.pathsep + pythonhome
    os.environ["PATH"] += os.pathsep + bin_path
    os.environ["PATH"] += os.pathsep + core_path